<div class="card mb-4 shadow-sm
    {% if pedido.status == 'preparando' %}bg-warning text-dark bg-opacity-50
    {% elif pedido.status == 'pronto' %}bg-info text-dark bg-opacity-50
    {% elif pedido.status == 'entregue' %}bg-success text-white bg-opacity-75
    {% elif pedido.status == 'cancelado' %}bg-secondary text-white bg-opacity-75
    {% else %}bg-light
    {% endif %}
" id="pedido-{{ pedido.id }}">


    <div class="card-header d-flex justify-content-between">
        <strong>#{{ pedido.id }} - {{ pedido.cliente.nome }} - {{ pedido.cliente.whatsapp}}</strong>
        <span>{{ pedido.criado_em|date:"d/m/Y H:i" }}</span>
    </div>

    <div class="card-body">
        <p><strong>Status:</strong> <span id="status-text-{{ pedido.id }}">{{ pedido.get_status_display }}</span></p>
        <p><strong>Tipo:</strong> {{ pedido.get_tipo_entrega_display }}</p>

        {% if pedido.tipo_entrega == 'entrega' and pedido.bairro %}
        <p><strong>Bairro:</strong> {{ pedido.bairro.nome }} - R$ {{ pedido.bairro.valor_frete|floatformat:2 }}</p>
        <p><strong>Endereço:</strong> {{ pedido.endereco_entrega }}</p>
        {% endif %}

        <ul class="list-group mb-3">
            {% for item in pedido.itens.all %}
            <li class="list-group-item d-flex justify-content-between">
                {{ item.produto.nome }} x{{ item.quantidade }}
                <span>R$ {{ item.subtotal|floatformat:2 }}</span>
            </li>
            {% endfor %}
        </ul>

        <h5 class="mb-3">Total: R$ {{ pedido.total|floatformat:2 }}</h5>

        <div class="d-flex justify-content-between align-items-center mb-3">
                    <span id="status-pago-{{ pedido.id }}" 
                          class="badge {% if pedido.pago %}bg-success{% else %}bg-danger{% endif %}">
                        {% if pedido.pago %}PAGO{% else %}NÃO PAGO{% endif %}
                    </span>
                    <button type="button" 
                            class="btn btn-sm {% if pedido.pago %}btn-outline-danger{% else %}btn-outline-success{% endif %} btn-toggle-pago"
                            data-pedido-id="{{ pedido.id }}">
                        {% if pedido.pago %}Marcar como Não Pago{% else %}Marcar como Pago{% endif %}
                    </button>
                </div>

        <div class="btn-group" role="group">
            <button type="button" class="btn btn-outline-warning btn-sm btn-atualizar-status"
                data-pedido-id="{{ pedido.id }}" data-novo-status="preparando">👨‍🍳 Preparando</button>
            <button type="button" class="btn btn-outline-info btn-sm btn-atualizar-status"
                data-pedido-id="{{ pedido.id }}" data-novo-status="pronto">📦 Pronto</button>
            <button type="button" class="btn btn-outline-success btn-sm btn-atualizar-status"
                data-pedido-id="{{ pedido.id }}" data-novo-status="entregue">🏁 Entregue</button>
            <button type="button" class="btn btn-outline-danger btn-sm btn-atualizar-status"
                data-pedido-id="{{ pedido.id }}" data-novo-status="cancelado">❌ Cancelar</button>
        </div>

        <div class="mt-2">
            <button type="button" class="btn btn-outline-secondary btn-sm btn-imprimir-pedido"
                data-pedido-id="{{ pedido.id }}">
                🖨️ Imprimir
            </button>
        </div>

    </div>
</div>